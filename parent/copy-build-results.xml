<?xml version="1.0" encoding="UTF-8"?>
<!--
    Copyright (c) 2011, 2014 SAP AG.
    All rights reserved. This program and the accompanying materials
    are made available under the terms of the Eclipse Public License 2.0
    which accompanies this distribution, and is available at
    https://www.eclipse.org/legal/epl-2.0/

    SPDX-License-Identifier: EPL-2.0
   
    Contributors:
        SAP AG - initial implementation
 -->
<project name="copy-build-results" default="default" basedir=".">
	<target name="default"
		depends="initProperties,copyProducts,copyUpdateSite,cleanupBuild">
		<echo message="${env.cleanupBuild}" />
		<echo message="${env.result}" />
	</target>

	<target name="initProperties">
		<property name="buildResultsDir" value="../../latestBuildResults" />
		<property name="producedRCPsDir" value="../org.eclipse.mat.product/target/products" />
		<property name="producedUpdateSiteDir" value="../org.eclipse.mat.updatesite/target/repository" />
		<property environment="env" />

		<delete dir="${buildResultsDir}" />
	</target>

	<target name="copyProducts" description="Copy produced RCPs">
		<copy todir="${buildResultsDir}/rcp">
			<fileset dir="${producedRCPsDir}/">
				<include name="*.zip" />
			</fileset>
		</copy>
	</target>

	<target name="copyUpdateSite" description="Copy produced update site">
		<copy todir="${buildResultsDir}/update-site">
			<fileset dir="${producedUpdateSiteDir}/" />
		</copy>
	</target>

	<target name="cleanupBuild" description="Removes target folders generated by mvn"
		if="env.cleanupBuild">
		<echo message="Cleaning up org.eclipse.mat.product/target/ directory" />
		<delete dir="../org.eclipse.mat.product/target" />
	</target>

</project>
